<?phpclass Display_model extends CI_Model {	public function __construct() {		$this->load->database();		$this->load->library('session');	}			public function getAllItem() {		$sql = "SELECT * FROM local_store_".$this->session->userdata('store_id')."_item a, category b, category_main c WHERE a.c_id = b.c_id AND b.c_main_id = c.c_main_id ORDER BY a.name LIMIT 0, 50";		$query = $this->db->query($sql);			return $query->result_array();	}		public function getAllItemByCMainId($id) {		$sql = "SELECT * FROM local_store_".$this->session->userdata('store_id')."_item a, category b, category_main c WHERE a.c_id = b.c_id AND b.c_main_id = c.c_main_id AND b.c_main_id = '".$id."' LIMIT 0, 100";		$query = $this->db->query($sql);				return $query->result_array();	}		public function getAllItemByManu($manufacturer) {		$sql = "SELECT * FROM local_store_".$this->session->userdata('store_id')."_item a, category b, category_main c WHERE a.c_id = b.c_id AND b.c_main_id = c.c_main_id AND a.manufacturer = '".$manufacturer."'";		$query = $this->db->query($sql); 				return $query->result_array();	}		public function getAllMainCategory() {		$query = $this->db->get('category_main');				return $query->result_array();	}		public function getAllCategory() {		$query = $this->db->get('category');				return $query->result_array();	}		public function getItemByMainCategory($c_main_id) {		$sql = "SELECT * FROM local_store_".$this->session->userdata('store_id')."_item a, category b, category_main c WHERE a.c_id = b.c_id AND b.c_main_id = c.c_main_id AND b.c_main_id = '".$c_main_id."' ORDER BY a.discount ASC LIMIT 0, 2";		$query = $this->db->query($sql);				return $query->result_array();	}		public function getItemSearched($keyword, $minprice, $maxprice, $c_main_id, $search_sort)	{		$sql = "SELECT * FROM local_store_".$this->session->userdata('store_id')."_item a, category b, category_main c WHERE (a.c_id = b.c_id AND b.c_main_id = c.c_main_id AND a.name LIKE '%".$keyword."%') OR ( a.c_id = b.c_id AND b.c_main_id = c.c_main_id AND a.manufacturer LIKE '%".$keyword."%' ) OR ( a.c_id = b.c_id AND b.c_main_id = c.c_main_id AND c.c_main_name LIKE '%".$keyword."%') OR (a.c_id = b.c_id AND b.c_main_id = c.c_main_id AND b.c_name LIKE '%".$keyword."%') ORDER BY a.discounted_price ".$search_sort ;		$query = $this->db->query($sql);		$all_items = $query->result_array();				$search_items = array();					if ($minprice != "" && $maxprice != "" && $c_main_id == 0) {				foreach($all_items as $key => $item) {					if($item['price'] * $item['discount'] <= $maxprice && $item['price'] * $item['discount'] >= $minprice) // isset($minprice) && isset($maxprice) && $category == 0					{						array_push($search_items, $item);					}				}			}			elseif ($minprice == "" && $maxprice != "" && $c_main_id == 0) {				foreach($all_items as $key => $item) {					if($item['price'] * $item['discount'] <= $maxprice)  // !isset($minprice) && isset($maxprice) && $category == 0					{						array_push($search_items, $item);					}				}			}						elseif ($minprice != "" && $maxprice == "" && $c_main_id == 0) {				foreach($all_items as $key => $item) {					if($item['price'] * $item['discount'] >= $minprice)  // $minprice != "" && !$maxprice != "" && $category == 0					{						array_push($search_items, $item);					}				}			}						elseif ($minprice != "" && $maxprice != "" && $c_main_id != 0) {				foreach($all_items as $key => $item) {					if($item['price'] * $item['discount'] <= $maxprice && $item['price'] * $item['discount'] >= $minprice && $item['c_main_id'] == $c_main_id)  // $minprice != "" && $maxprice != "" && $category != 0					{						array_push($search_items, $item);					}				}			}						elseif ($minprice == "" && $maxprice != "" && $c_main_id != 0) {				foreach($all_items as $key => $item) {					if($item['price'] * $item['discount'] <= $maxprice && $item['c_main_id'] == $c_main_id)  // !$minprice != "" && $maxprice != "" && $c_main_id != 0					{						array_push($search_items, $item);					}				}			}						elseif ($minprice != "" && $maxprice == "" && $c_main_id != 0) {				foreach($all_items as $key => $item) {					if($item['price'] * $item['discount'] >= $minprice && $item['c_main_id'] == $c_main_id)  // $minprice != "" && !$maxprice != "" && $c_main_id != 0					{						array_push($search_items, $item);					}				}			}						elseif ($minprice == "" && $maxprice == "" && $c_main_id != 0) {				foreach($all_items as $key => $item) {					if($item['c_main_id'] == $c_main_id)  // !$minprice != "" && !$maxprice != "" && $c_main_id != 0					{						array_push($search_items, $item);					}				}			}						else { // go do display index $minprice == "" && $maxprice == "" && $c_main_id == 0				$search_items = $all_items;			}				return $search_items;	}}